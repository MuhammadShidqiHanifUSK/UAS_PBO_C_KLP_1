<!--
  File ini adalah template HTML menggunakan Thymeleaf untuk halaman manajemen produk pada panel admin.
  Fungsi utama file ini adalah untuk menampilkan antarmuka agar admin dapat:
    - Menambahkan produk baru ke sistem
    - Melihat daftar produk yang sudah ada beserta detailnya
    - Mengedit dan memperbarui data produk (nama, harga, stok)
    - Menghapus produk yang tidak diperlukan
    - Melakukan navigasi cepat ke dashboard admin dan halaman transaksi

  File ini menggunakan framework Thymeleaf untuk menghubungkan data dinamis dari backend (kemungkinan besar
  menggunakan kelas Controller AdminController) ke tampilan frontend.
  Dengan file ini, admin dapat mengelola inventaris produk secara langsung dari web tanpa perlu akses ke database secara manual.

-->

<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{fragments/header}">
<head>
  <title>Kelola Produk</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body>
  <div layout:fragment="content">
    <div class="container admin-dashboard">
      <h1 class="page-header">Manajemen Produk</h1>

      <!-- Form untuk menambah produk baru, data dikirim ke endpoint /admin/products/add dengan metode POST -->
      <div class="card">
        <div class="card-header">
          Tambah Produk Baru
        </div>
        <div class="card-body">
          <form th:action="@{/admin/products/add}" method="post">
            <div class="row">
              <div class="col">
                <div class="form-group">
                  <label class="form-label" for="name">Nama Produk</label>
                  <input type="text" id="name" name="name" class="form-control" placeholder="Masukkan nama produk" required />
                </div>
              </div>
              <div class="col">
                <div class="form-group">
                  <label class="form-label" for="price">Harga (Rp)</label>
                  <input type="number" id="price" name="price" class="form-control" placeholder="Masukkan harga" min="0" required />
                </div>
              </div>
              <div class="col">
                <div class="form-group">
                  <label class="form-label" for="stock">Jumlah Stok</label>
                  <input type="number" id="stock" name="stock" class="form-control" placeholder="Masukkan stok" min="0" required />
                </div>
              </div>
            </div>
            <button type="submit" class="btn btn-success">
              Tambah Produk
            </button>
          </form>
        </div>
      </div>

      <!-- Daftar produk yang ditampilkan mengacu pada variabel 'products' yang dikirim dari backend -->
      <div class="card">
        <div class="card-header">
          Semua Produk ([[${#lists.size(products)}]])
        </div>
        <div class="card-body">
          <!-- Tampilan pesan jika tidak ada produk sama sekali -->
          <div th:if="${#lists.isEmpty(products)}" class="alert alert-warning">
            Tidak ada produk tersedia. Tambahkan produk pertama Anda di atas!
          </div>

          <!-- Grid produk yang memuat daftar produk dengan fungsi tambah, edit, dan hapus -->
          <div th:if="${!#lists.isEmpty(products)}" class="product-grid">
            <div th:each="product : ${products}" class="product-card">
              <div class="product-header">
                <h3 th:text="${product.name}">Nama Produk</h3>
                <div class="product-price">Rp [[${#numbers.formatInteger(product.price, 0, 'COMMA')}]]</div>
              </div>
              <div class="product-body">
                <!-- Menampilkan stok produk dengan indikator kelas CSS untuk stok banyak, sedikit, atau habis -->
                <div class="product-stock" th:class="'product-stock ' + (${product.stock} > 10 ? 'available' : (${product.stock} > 0 ? 'low' : 'out'))"
                     th:text="'Stok: ' + ${product.stock}">Stok</div>

                <!-- Form untuk mengedit data produk, submit ke /admin/products/update -->
                <form th:action="@{/admin/products/update}" method="post">
                  <input type="hidden" name="id" th:value="${product.id}" />
                  <div class="edit-form-grid">
                    <div class="form-group">
                      <label class="form-label">Nama</label>
                      <input type="text" name="name" th:value="${product.name}" class="form-control" placeholder="Nama" required />
                    </div>
                    <div class="form-group">
                      <label class="form-label">Harga</label>
                      <input type="number" name="price" th:value="${product.price}" class="form-control" placeholder="Harga" min="0" required />
                    </div>
                    <div class="form-group">
                      <label class="form-label">Stok</label>
                      <input type="number" name="stock" th:value="${product.stock}" class="form-control" placeholder="Stok" min="0" required />
                    </div>
                  </div>
                  <button type="submit" class="btn btn-warning btn-sm">
                    Perbarui
                  </button>
                </form>

                <!-- Form untuk menghapus produk, submit ke /admin/products/delete -->
                <form th:action="@{/admin/products/delete}" method="post">
                  <input type="hidden" name="id" th:value="${product.id}" />
                  <button type="submit" class="btn btn-danger btn-sm"
                          onclick="return confirm('Apakah Anda yakin ingin menghapus produk ini?');">
                    Hapus
                  </button>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Bagian tindakan cepat untuk navigasi ke fitur penting lain seperti dashboard dan transaksi -->
      <div class="card">
        <div class="card-header">
          Tindakan Cepat
        </div>
        <div class="card-body">
          <div class="d-flex gap-3 flex-wrap">
            <a th:href="@{/admin}" class="btn btn-secondary">
              Kembali ke Dashboard
            </a>
            <a th:href="@{/admin/transactions}" class="btn btn-primary">
              Lihat Transaksi
            </a>
            <form th:action="@{/admin/save}" method="post">
              <button type="submit" class="btn btn-success">
                Simpan Perubahan
              </button>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</body>
</html>
